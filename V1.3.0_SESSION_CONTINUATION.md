# ğŸ”„ V1.3.0 - CONTEXTO DE CONTINUAÃ‡ÃƒO DA SESSÃƒO

**Data:** 03 de Novembro de 2025 21:11  
**Status:** ğŸŸ¡ IMPLEMENTAÃ‡ÃƒO EM ANDAMENTO  
**Branch:** main  
**VersÃ£o Atual:** 1.1.0

---

## ğŸ“‹ RESUMO DO QUE FOI DISCUTIDO

### âœ… CorreÃ§Ãµes jÃ¡ Identificadas e Validadas

#### 1. **CorreÃ§Ã£o de Datas e Stripe Mode**
- âœ… Atualizado todas as datas de 2024 â†’ 2025 (sistema usa calendÃ¡rio!)
- âœ… Corrigido Stripe: modo TEST (nÃ£o LIVE)
- âœ… Atualizado documentaÃ§Ã£o: CONTEXTO.md, DOCUMENTACAO.md, LEIA_PRIMEIRO.md, GUIA_TECNICO.md
- âœ… VersÃ£o atualizada: 1.0.2 â†’ 1.1.0

#### 2. **Problema CrÃ­tico: MusculaÃ§Ã£o Auto-Adicionada**
**SituaÃ§Ã£o:** Ao criar plano, usuÃ¡rio informa apenas dias de corrida, mas sistema adiciona musculaÃ§Ã£o automaticamente nos outros dias.

**DecisÃ£o do UsuÃ¡rio:** 
- âŒ NUNCA adicionar modalidades que o usuÃ¡rio nÃ£o informou
- âœ… Apenas o usuÃ¡rio escolhe disponibilidade (onboarding ou perfil)
- âœ… AlteraÃ§Ãµes no perfil devem auto-ajustar o plano automaticamente

**CorreÃ§Ãµes NecessÃ¡rias:**
1. Remover lÃ³gica de sugestÃ£o automÃ¡tica de modalidades
2. Implementar auto-ajuste quando usuÃ¡rio alterar perfil (OPÃ‡ÃƒO A = GRATUITO)
3. Premium apenas para: integraÃ§Ã£o Strava + anÃ¡lise de treinos + sugestÃµes baseadas em performance

#### 3. **Outras CorreÃ§Ãµes Identificadas**

**Onboarding:**
- âœ… Sexo: apenas Masculino/Feminino (remover "outro")
- ğŸ”„ Implementar 3 fases (vocÃª vai implementar)
- ğŸ”„ Garantir que TUDO no onboarding seja editÃ¡vel no perfil

**Dashboard:**
- âŒ Dia de descanso NÃƒO deve ter botÃ£o "concluir treino"
- ğŸ”„ Dia de descanso deve sugerir atividades complementares (IA)
- âŒ TÃ­tulos dos treinos nÃ£o batem com descriÃ§Ã£o/km

**Funcionalidade "Aplicar Ajuste":**
- âŒ Clica em "aplicar ajuste" â†’ treinos somem, plano fica carregando
- âŒ "Excluir plano" nÃ£o funciona, mas reverte o ajuste
- ğŸ”„ Auto-ajuste deve ser do dia da alteraÃ§Ã£o em diante (OPÃ‡ÃƒO 1 = nÃ£o excluir histÃ³rico)

---

## ğŸ¯ PLANO DE IMPLEMENTAÃ‡ÃƒO V1.3.0

### **DECISÃƒO DO USUÃRIO: OpÃ§Ã£o A - Continuar agora e finalizar (2-3h)**

### **Fase 1: AnÃ¡lise Completa do Onboarding** âœ… VOCÃŠ VAI IMPLEMENTAR
1. Avaliar incongruÃªncias no onboarding
2. Identificar redundÃ¢ncias
3. Verificar dados nÃ£o considerados pela IA
4. Propor melhorias como "super treinador"
5. Implementar 3 fases do onboarding

### **Fase 2: Perfil & Editabilidade** âœ… VOCÃŠ VAI IMPLEMENTAR
1. Garantir que TUDO no onboarding seja editÃ¡vel no perfil
2. Organizar/adequar interface do perfil
3. Implementar auto-ajuste gratuito (alteraÃ§Ãµes de perfil â†’ plano)

### **Fase 3: CorreÃ§Ãµes Dashboard** âœ… VOCÃŠ VAI IMPLEMENTAR
1. Remover botÃ£o "concluir treino" do descanso
2. Adicionar sugestÃµes IA para dia de descanso
3. Corrigir tÃ­tulos vs descriÃ§Ã£o dos treinos
4. Consertar funcionalidade "aplicar ajuste"

### **Fase 4: Deploy & DocumentaÃ§Ã£o** ğŸ”„ PENDENTE
1. Realizar deploy
2. Atualizar documentaÃ§Ã£o completa
3. Atualizar contexto

---

## ğŸ” ANÃLISE TÃ‰CNICA - ONDE ESTÃƒO OS PROBLEMAS

### **1. Disponibilidade Auto-Adicionada**

**Arquivos Envolvidos:**
```
nextjs_space/app/api/training-plan/generate/route.ts
nextjs_space/lib/training-plan/generator.ts
nextjs_space/lib/openai/training-plan-prompt.ts
```

**LÃ³gica a Remover:**
- Qualquer cÃ³digo que adicione modalidades nÃ£o informadas pelo usuÃ¡rio
- SugestÃµes automÃ¡ticas de musculaÃ§Ã£o/yoga/etc

**LÃ³gica a Adicionar:**
- Auto-ajuste gratuito quando perfil mudar
- Mensagem premium para ajustes baseados em performance

### **2. Problema "Aplicar Ajuste"**

**Arquivo ProvÃ¡vel:**
```
nextjs_space/app/dashboard/page.tsx (ou componente relacionado)
nextjs_space/app/api/training-plan/adjust/route.ts
```

**Comportamento Atual:**
- Clica "aplicar ajuste" â†’ API falha ou nÃ£o retorna
- Frontend remove treinos esperando resposta que nunca vem
- "Excluir plano" reverte (cache? estado local?)

**SoluÃ§Ã£o:**
- Debugar API de ajuste
- Implementar loading state correto
- Auto-ajuste deve preservar histÃ³rico

### **3. Onboarding - 3 Fases a Implementar**

**Estrutura Proposta (vocÃª vai detalhar):**
```
Fase 1: Perfil do Corredor
- Dados bÃ¡sicos (nome, sexo M/F, idade, peso)
- ExperiÃªncia (iniciante, intermediÃ¡rio, avanÃ§ado)
- HistÃ³rico de corrida

Fase 2: Objetivos & Disponibilidade
- Corridas alvo (A, B, C)
- Dias disponÃ­veis (APENAS o que usuÃ¡rio escolher)
- RestriÃ§Ãµes/lesÃµes

Fase 3: PreferÃªncias & ConfirmaÃ§Ã£o
- Estilo de treino
- Review final
- GeraÃ§Ã£o do plano
```

### **4. Perfil - Editabilidade Completa**

**Campos que DEVEM ser editÃ¡veis:**
- âœ… Dados pessoais (nome, sexo, idade, peso)
- âœ… ExperiÃªncia e VDOT
- âœ… Corridas (adicionar/remover/editar)
- âœ… Disponibilidade semanal (modalidades + dias)
- âœ… RestriÃ§Ãµes/lesÃµes
- âœ… PreferÃªncias de treino

**Auto-ajuste ao editar:**
- Disponibilidade alterada â†’ regenerar semanas futuras
- Corrida adicionada/removida â†’ recalcular periodizaÃ§Ã£o
- VDOT alterado â†’ recalcular paces

---

## ğŸ’¾ ESTADO ATUAL DO CÃ“DIGO

### Git Status
```
On branch main
Your branch is up to date with 'origin/main'
nothing to commit, working tree clean
```

### DocumentaÃ§Ã£o Atualizada
- âœ… CONTEXTO.md (1.1.0, Nov 2025, Stripe TEST)
- âœ… DOCUMENTACAO.md (1.1.0, Nov 2025)
- âœ… LEIA_PRIMEIRO.md (1.1.0, Nov 2025)
- âœ… GUIA_TECNICO.md (1.1.0, Nov 2025)

### Arquivos NÃƒO Atualizados (verificar)
- â“ README.md (pode conter datas 2024)
- â“ ROADMAP.md (pode conter datas 2024)
- â“ Outros arquivos .md

---

## ğŸš€ PRÃ“XIMOS PASSOS (CONTINUAÃ‡ÃƒO)

### 1ï¸âƒ£ **AnÃ¡lise Profunda do Onboarding**
```bash
# Arquivos a analisar
nextjs_space/app/onboarding/
nextjs_space/components/onboarding/
nextjs_space/lib/training-plan/generator.ts
nextjs_space/lib/openai/training-plan-prompt.ts
```

**Perguntas a responder:**
- Quais dados estÃ£o sendo coletados?
- Quais NÃƒO estÃ£o sendo usados na geraÃ§Ã£o do plano?
- O que Ã© redundante?
- O que falta (perspectiva de treinador)?

### 2ï¸âƒ£ **Implementar 3 Fases**
- Redesenhar fluxo do onboarding
- Separar em componentes claros
- Melhorar UX e clareza

### 3ï¸âƒ£ **Corrigir LÃ³gica de Disponibilidade**
```typescript
// REMOVER lÃ³gica tipo:
if (availableDays.length < 5) {
  addWeightTraining() // âŒ NUNCA FAZER ISSO
}

// ADICIONAR:
// Apenas usar o que usuÃ¡rio informou
const userSelectedActivities = profile.availability
```

### 4ï¸âƒ£ **Implementar Auto-Ajuste Gratuito**
```typescript
// Quando perfil mudar
onProfileUpdate() {
  const changes = detectChanges()
  if (changes.affectsTrainingPlan) {
    regenerateFutureWeeks() // Do dia atual em diante
  }
}
```

### 5ï¸âƒ£ **Corrigir Bugs Dashboard**
- Descanso sem botÃ£o "concluir"
- TÃ­tulos corretos nos treinos
- Consertar "aplicar ajuste"

---

## ğŸ“ OBSERVAÃ‡Ã•ES IMPORTANTES

### Regra de Ouro
> **"Quem faz 100% da escolha de disponibilidade Ã© o usuÃ¡rio"**

### Premium vs Gratuito
**GRATUITO:**
- âœ… Auto-ajuste por mudanÃ§as de perfil (agenda)
- âœ… Editar disponibilidade/corridas a qualquer momento

**PREMIUM:**
- ğŸ’ IntegraÃ§Ã£o Strava
- ğŸ’ AnÃ¡lise de treinos realizados
- ğŸ’ SugestÃµes baseadas em performance
- ğŸ’ Mensagem: "Com Premium, vocÃª teria uma sugestÃ£o de atualizaÃ§Ã£o baseada no seu desenvolvimento"

### Deploy
- âš ï¸ NÃƒO fazer deploy atÃ© TUDO estar testado
- âš ï¸ Ambiente compartilhado (dev + prod = mesmo banco)
- âš ï¸ Testar localmente antes

---

## ğŸ¯ OBJETIVO FINAL DA V1.3.0

1. âœ… Onboarding otimizado (3 fases, claro, sem redundÃ¢ncia)
2. âœ… Perfil 100% editÃ¡vel
3. âœ… Auto-ajuste gratuito funcional
4. âœ… Bugs corrigidos (descanso, tÃ­tulos, ajuste)
5. âœ… LÃ³gica de disponibilidade correta (usuÃ¡rio decide TUDO)
6. âœ… DocumentaÃ§Ã£o atualizada
7. âœ… Deploy estÃ¡vel

---

## ğŸ’¬ CONTEXTO DA CONVERSA

**UsuÃ¡rio:** Maurillio  
**Tom:** Direto, objetivo, quer implementaÃ§Ã£o rÃ¡pida e correta  
**Estilo:** "mete bronca!!" = fazer com qualidade e agilidade  

**Expectativa:**
- ImplementaÃ§Ã£o completa hoje (2-3h)
- AnÃ¡lise profunda de treinador
- CorreÃ§Ãµes cirÃºrgicas (nÃ£o quebrar nada)
- DocumentaÃ§Ã£o sempre atualizada

---

## ğŸ”„ COMO CONTINUAR ESTA SESSÃƒO

1. **Leia este arquivo primeiro**
2. **Execute:** `cd /root/athera-run/nextjs_space`
3. **Analise:** Onboarding, perfil, lÃ³gica de geraÃ§Ã£o
4. **Implemente:** CorreÃ§Ãµes e melhorias
5. **Teste:** Localmente antes do deploy
6. **Deploy:** Quando tudo estiver OK
7. **Atualize:** Este arquivo e documentaÃ§Ã£o

---

**Status Final desta SessÃ£o:** ğŸŸ¡ PRONTO PARA CONTINUAR  
**PrÃ³xima AÃ§Ã£o:** AnÃ¡lise profunda do onboarding + implementaÃ§Ã£o das 3 fases

---

**Â© 2025 Athera Run**
